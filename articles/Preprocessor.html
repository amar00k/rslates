<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Preprocessing Directives • rslates</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Preprocessing Directives">
<meta property="og:description" content="rslates">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">rslates</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="Unreleased version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/rslates.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/preprocessor.html">Preprocessing Directives</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/amar00k/rslates/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="Preprocessor_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Preprocessing Directives</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/amar00k/rslates/blob/master/vignettes/preprocessor.Rmd"><code>vignettes/preprocessor.Rmd</code></a></small>
      <div class="hidden name"><code>preprocessor.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h1>
<p>Slate blueprints are just regular R source code files decorated with <em>slates</em> preprocessing directives. These directives define the inputs that will appear on the slate, the outputs and their source code, importing datasets, and so on.</p>
<p>The <em>Slates</em> preprocessor is responsible to convert <strong>decorated code</strong> to regular R source code that can be parsed and executed by the R interpreter. As this latter source code is the one that the user will see, we refer to it as <strong>user code</strong>.</p>
<p>Slates directives are grouped in the following categories:</p>
<ul>
<li>Commenting: <code>#</code>, <code>##</code> and <code>###</code>.</li>
<li>Input definition: <code>$@&lt;input|page|group&gt;</code>.<br>
</li>
<li>Section declaration: <code>$@&lt;exec|print|plot|table|...&gt; &lt;name&gt;</code>.</li>
<li>Variable substitution: <code>${ ... }</code>.</li>
<li>Conditional output <code>$#[&lt;condition&gt;] ...</code>.</li>
</ul>
</div>
<div id="example" class="section level1">
<h1 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h1>
<p>We start with a complete example showing off most features of the preprocessing engine.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="op">$</span><span class="er">@</span>title <span class="st">"Scatterplot"</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="op">$</span><span class="er">@</span>tags <span class="st">"example"</span>, <span class="st">"rgraphics"</span>, <span class="st">"scatterplot"</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="op">$</span><span class="er">@</span>preamble <span class="ot">FALSE</span></span>
<span id="cb1-4"><a href="#cb1-4"></a> </span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">## $@input x(expression, "1:10", description = "x coordinates for the plot; or structure defining both x and y coordinates.")</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">## $@input y(expression, description = "y coordinates for the plot.")</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">## </span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">## $@input type(choices, "p",</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">##              choices = list("Points"="p", "Lines"="l", "Both"="b", "Empty Points"="c",</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">##                             "Overplotted"="o", "Stairs (Floor)"="s", "Stairs (Ceiling)"="S"),</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">##              description = "desired type of plot.")</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">## </span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="co">## $@input main(character, description = "main title for the plot.")</span></span>
<span id="cb1-14"><a href="#cb1-14"></a><span class="co">## $@input xlab(character, description = "label for the x-axis.")</span></span>
<span id="cb1-15"><a href="#cb1-15"></a><span class="co">## $@input ylab(character, description = "label for the y-axis.")</span></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">## </span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">## $@input xlim(numeric2, c(NA, NA), description = "x limits (x1, x2) for the plot.")</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">## $@input ylim(numeric2, c(NA, NA), description = "y limits (x1, x2) for the plot.")</span></span>
<span id="cb1-19"><a href="#cb1-19"></a></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="op">$</span><span class="er">@</span>output <span class="kw">plot</span>(Scatterplot)</span>
<span id="cb1-21"><a href="#cb1-21"></a></span>
<span id="cb1-22"><a href="#cb1-22"></a><span class="co"># set the margins for the plot</span></span>
<span id="cb1-23"><a href="#cb1-23"></a><span class="kw">par</span>(<span class="dt">mar=</span><span class="kw">c</span>(<span class="op">$</span>{mar_bottom, mar_left, mar_top, mar_right}))</span>
<span id="cb1-24"><a href="#cb1-24"></a></span>
<span id="cb1-25"><a href="#cb1-25"></a><span class="co"># do the plot</span></span>
<span id="cb1-26"><a href="#cb1-26"></a><span class="kw">plot</span>(<span class="op">$</span>{dn<span class="op">::</span><span class="st"> </span>x<span class="op">:</span>x, y=<span class="kw">y</span>(<span class="dt">check.valid =</span> <span class="ot">FALSE</span>), type=type, main=main, xlab=xlab, ylab=ylab})</span>
<span id="cb1-27"><a href="#cb1-27"></a></span>
<span id="cb1-28"><a href="#cb1-28"></a><span class="op">$</span><span class="er">@</span>end<span class="op">-</span>output</span></code></pre></div>
</div>
<div id="comments" class="section level1">
<h1 class="hasAnchor">
<a href="#comments" class="anchor"></a>Comments</h1>
<p>Comments come in three flavors (<code>#</code>, <code>##</code> and <code>###</code>). These affect what comments will be <em>displayed</em>, <em>suppressed</em> and/ or <em>interpreted</em> by the preprocessor.</p>
<div id="single-hash" class="section level2">
<h2 class="hasAnchor">
<a href="#single-hash" class="anchor"></a>Single Hash (<code>#</code>)</h2>
<p>A regular R comment. This comment will show up in the final source that is provided to the user. Any preprocessor directives included in the comment are interpreted by the preprocessor and removed from the source.</p>
</div>
<div id="double-hash" class="section level2">
<h2 class="hasAnchor">
<a href="#double-hash" class="anchor"></a>Double Hash (<code>##</code>)</h2>
<p>Will suppressed from user code, but preprocessing directives are interpreted .</p>
</div>
<div id="triple-hash" class="section level2">
<h2 class="hasAnchor">
<a href="#triple-hash" class="anchor"></a>Triple Hash (<code>###</code>)</h2>
<p>A <em>slates</em> comment: these are used to comment the <em>slates</em> source code itself, as they will be suppressed from the user code and ignored by the preprocessor.</p>
</div>
</div>
<div id="inputs-groups-and-pages" class="section level1">
<h1 class="hasAnchor">
<a href="#inputs-groups-and-pages" class="anchor"></a>Inputs, Groups and Pages</h1>
<p>Inputs, groups and pages are defined through the <code>$@input</code>, <code>$@group</code> and <code>$@page</code> directives. After evaluation, these directives are scrubbed from the user code, and so can be placed outside of comments. However, placing them in double-hash comments may facilitate code-formatting by avoiding unnecessary empty lines in the user code.</p>
<div id="inputs" class="section level2">
<h2 class="hasAnchor">
<a href="#inputs" class="anchor"></a>Inputs</h2>
<blockquote>
<p><code>$@input name(type, default, ...)</code></p>
</blockquote>
<p>Inputs are defined using the syntax <code>$@input name(type, default, ...)</code> where <code>name</code> is the variable name associated with the input, <code>type</code> is the input type, and <code>default</code> is the default value of the input.</p>
<p>Input types include <code>character</code>, <code>numeric</code>, <code>logical</code>, <code>choices</code>, <code>expression</code>, <code>numeric2</code> and <code>numeric4</code>. See ??? for a list of supported input types.</p>
<div id="usage" class="section level3">
<h3 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h3>
<p>In the simplest case, an input may be defined with just a name. In this case it will assume the default <code>character</code> type. The default value will depend on the input type.</p>
<pre><code>## defines an input 'x' of type 'character' (the default input type).
## $@input x</code></pre>
<p>The <em>input type</em> and <em>default value</em> can be specified with or without parameter names.</p>
<pre><code>## defines a 'numeric' input with the name 'num_samples' and default value 10.
## $@input num_samples(numeric, 10)
## $@input num_samples(type = numeric, default = 10)</code></pre>
<p>Additional parameters must be specified by name. Common user-interface options include <code>description</code>, that determines the tooltip text for the input and <code>pretty.name</code> that, if provided, will be used in the user-interface instead of the variable name.</p>
<pre><code>## $@input x(expression, expression(1:10), description="x coordinates for the plot.", pretty.name = "x-coordinates")</code></pre>
<p><em>Note:</em> for convenience it is not required to quote the input type parameter, although one may do so if desired. <code>$@input x(character)</code> is equivalent to <code>$@input x("character")</code>.</p>
</div>
</div>
<div id="groups" class="section level2">
<h2 class="hasAnchor">
<a href="#groups" class="anchor"></a>Groups</h2>
<blockquote>
<p><code>$@group name(layout, ...)</code></p>
</blockquote>
</div>
</div>
<div id="outputs-and-datasets" class="section level1">
<h1 class="hasAnchor">
<a href="#outputs-and-datasets" class="anchor"></a>Outputs and Datasets</h1>
<blockquote>
<p><code>$@output name(type, ...)</code> … <code>$@end-output</code></p>
</blockquote>
<blockquote>
<p><code>$@dataset name(type, ...)</code> … <code>$@end-dataset</code></p>
</blockquote>
</div>
<div id="variable-substitution" class="section level1">
<h1 class="hasAnchor">
<a href="#variable-substitution" class="anchor"></a>Variable Substitution</h1>
<blockquote>
<p><code>${options:varname}</code></p>
</blockquote>
<blockquote>
<p><code>${default_options:: options1:varname1, options2:varname2, ...}</code></p>
</blockquote>
</div>
<div id="conditional-output" class="section level1">
<h1 class="hasAnchor">
<a href="#conditional-output" class="anchor"></a>Conditional Output</h1>
<blockquote>
<p><code>$@if expression</code> … <code>$@end-if</code></p>
</blockquote>
</div>
<div id="implementation-details" class="section level1">
<h1 class="hasAnchor">
<a href="#implementation-details" class="anchor"></a>Implementation Details</h1>
<p>Preprocessor definitions are searched for using simple regular expressions. Because we’re not using any parser, some additional syntactic rules are enforced:</p>
<ul>
<li>Definitions may span multiple lines, but <em>must end on a newline character</em> (i.e. they must not be followed by any other expressions)</li>
</ul>
<p>The exact expression is below.</p>
<blockquote>
<p>`\<span class="math inline">\(@ *(title|preamble|input|eval|print|plot|table|markdown) *[^ \n]+ *\\(.*?\\).*?\n|\\\)</span>@ <em>(title|preamble|input|eval|print|plot|table|markdown) </em>[^ ]+´</p>
</blockquote>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Daniel Neves.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
